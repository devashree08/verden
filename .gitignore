from __future__ import annotations
import os
from fastapi import Request

DEV_EID_HEADER = os.getenv("DEV_EID_HEADER", "X-User-EID")

def get_eid_dev(request: Request) -> str:
    """
    DEV ONLY: derive EID from trusted header or env.
    SECURITY: never expose EID in tool schemas or outputs.
    """
    val = request.headers.get(DEV_EID_HEADER)
    if val:
        return val.strip()
    env_eid = os.getenv("DEV_EID")
    if env_eid:
        return env_eid.strip()
    raise RuntimeError("Missing EID (dev). Provide header X-User-EID or DEV_EID env for local testing.")
