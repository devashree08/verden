def register_endpoint(app: FastAPI, ep: Dict[str, Any]) -> None:
    schema, proc, path, method = ep["schema"], ep["proc"], ep["path"], ep["method"].upper()
    summary, description = ep.get("summary", f"Execute {schema}.{proc}"), ep.get("description", "")

    # NEW: derive a tag from the first path segment, unless user sets tags/group explicitly
    explicit_tags = ep.get("tags")  # e.g., ["Allapps"]
    group = ep.get("group")         # e.g., "Allapps"
    derived = path.strip("/").split("/", 1)[0] or "default"
    tags = explicit_tags or [group] if group else [derived]
