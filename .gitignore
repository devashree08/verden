# Get likely WSL-related PIDs
$procs = Get-Process -Name wslhost,wsl,ubuntu*,bash -ErrorAction SilentlyContinue
$wslPids = $procs.Id

# Show only listeners owned by those PIDs
Get-NetTCPConnection -State Listen |
  Where-Object { $wslPids -contains $_.OwningProcess } |
  Sort-Object LocalAddress,LocalPort |
  Format-Table LocalAddress,LocalPort,State,OwningProcess
