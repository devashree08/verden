namespace YourApp.Api.Models.AttributeArtifacts
{
    public enum ArtifactListMode { Attribute, ReusePool }

    public sealed class MutateRequest
    {
        public string Action { get; set; } = default!; // "Link" | "Unlink"

        public int OrgID { get; set; }
        public int Csf2SubcategoryID { get; set; }
        public int MaturityLevel { get; set; }

        public int? Csf1SubcategoryID { get; set; }   // baseline only
        public int? AttributeNum { get; set; }        // baseline only
        public int? CustomAttributeNum { get; set; }  // custom only

        public string? Url { get; set; }              // required for Link; optional for Unlink if ArtifactLinkID provided
        public string? Title { get; set; }            // optional; ignored for Unlink
        public int? ArtifactLinkID { get; set; }      // optional shortcut for Unlink
    }

    public sealed class MutateLinkResult
    {
        public int ArtifactLinkID { get; set; }
        public int OrgID { get; set; }
        public int Csf2SubcategoryID { get; set; }
        public int MaturityLevel { get; set; }
        public int? Csf1SubcategoryID { get; set; }
        public int? AttributeNum { get; set; }
        public int? CustomAttributeNum { get; set; }
        public string Url { get; set; } = default!;
        public string? Title { get; set; }
        public bool IsActive { get; set; }
        public string? CreatedBy { get; set; }
        public DateTime CreatedAt { get; set; }
        public DateTime? UpdatedAt { get; set; }
    }

    public sealed class MutateUnlinkResult
    {
        public int Affected { get; set; }
    }

    public sealed class ArtifactListQuery
    {
        public ArtifactListMode Mode { get; set; }

        public int OrgID { get; set; }
        public int Csf2SubcategoryID { get; set; }

        // Mode=Attribute (full attribute identity)
        public int? MaturityLevel { get; set; }
        public int? Csf1SubcategoryID { get; set; }
        public int? AttributeNum { get; set; }
        public int? CustomAttributeNum { get; set; }

        // Mode=ReusePool
        public string? Q { get; set; }
    }

    public sealed class ArtifactItem
    {
        public int ArtifactLinkID { get; set; }
        public string Url { get; set; } = default!;
        public string? Title { get; set; }
        public string? CreatedBy { get; set; }
        public DateTime CreatedAt { get; set; }
        public DateTime? UpdatedAt { get; set; }
    }

    public sealed class ReuseArtifactItem
    {
        public string Url { get; set; } = default!;
        public string? Title { get; set; }
        public DateTime LastUsedAt { get; set; }
        public int Uses { get; set; }
    }

    public sealed class BulkExportRequest
    {
        public List<int>? OrgIDs { get; set; }
        public List<int>? Csf2SubcategoryIDs { get; set; }
    }

    public sealed class BulkExportRow
    {
        public int OrgID { get; set; }
        public int Csf2SubcategoryID { get; set; }
        public int MaturityLevel { get; set; }
        public int? Csf1SubcategoryID { get; set; }
        public int? AttributeNum { get; set; }
        public int? CustomAttributeNum { get; set; }
        public string? Artifacts { get; set; } // newline-delimited
    }
}
